{
  "name" : "mt_us_intl_report_to_kme_hub",
  "runtimeEnvironmentId" : "@aJ3uTEybEyEfIXJjngNNOu",
  "runtimeEnvironmentName" : "Next Gen Data Warehouse",
  "postProcessingCmd" : "cp $$TgtFilesDir/veevacrm.csv $$TgtFilesDirArchive/veevacrm_`date +%Y%m%d`.csv; mv $$TgtFilesDir/veevacrm.csv $$TgtFilesDir/veevacrm_`date +%Y%m%d`.csv;",
  "maxLogs" : 10,
  "parameters" : [
    {
      "name" : "$Src_us_intl_report$",
      "type" : "EXTENDED_SOURCE",
      "label" : "Src_Connection_Snowflake",
      "uiProperties" : {
        "connectionParameterized" : "true",
        "paramName" : "Src_Connection_Snowflake",
        "paramType-mapping" : "Connection",
        "logcnx" : "Src_Connection_Snowflake",
        "isSelectDistinct" : "false",
        "isMsrcFilterParameterized" : "false",
        "isMsrcSortParameterized" : "false",
        "objlabel" : "Src_Query",
        "objectParameterized" : "true",
        "objectParamName" : "Src_Query",
        "objectParamType-mapping" : "DataObject",
        "originalPath" : "Src_us_intl_report"
      },
      "sourceConnectionId" : "@dkut7bJJVE5kXAtjhIsbKZ",
      "connectionName" : "BIIB_Snowflake_SVC_IHUB_PROD",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : false
      },
      "runtimeAttrs" : {
        "Role" : "$$SRC_Snowflake_Role",
        "Database" : "$$SRC_IHUB_DB",
        "Warehouse" : "$$SRC_Warehouse",
        "SQL Override" : "SELECT\nSTG_ACCOUNT.EXTERNAL_ID_VOD__C AS MDM_ID\n,RDM.LOOSER AS LOSER_MDM_ID\n,STG_ACCOUNT.BIIB_SEND_to_KME__C AS SEND_TO_KMEE_HUB\n,STG_ACCOUNT.SALUTATION AS SALUTATION\n,STG_ACCOUNT.FIRSTNAME AS FIRST_NAME\n,STG_ACCOUNT.MIDDLE_VOD__C AS MIDDLE_NAME\n,STG_ACCOUNT.LASTNAME AS LAST_NAME\n,ltrim(rtrim(STG_ACCOUNT.LATINNAME)) AS LATIN_NAME\n,STG_ACCOUNT.BIIB_KME_Classification__c AS CLASSIFICATION\n,STG_ACCOUNT.SPECILATY_1_VOD__C AS SPECIALTY_1\n,STG_ACCOUNT.SPECIALTY_2_VOD__C AS SPECIALTY_2\n,STG_ACCOUNT.BIIB_THERAPEUTIC_AREA__C AS THERAPEUTIC_AREA\n,STG_ACCOUNT.COUNTRY_VOD__C AS COUNTRY\n,STG_ACCOUNT.BIIB_STATE__C AS STATE\n,STG_ACCOUNT.BIIB_CITY__C AS CITY\n,STG_ACCOUNT.LANGUAGE_VOD__C AS LANGUAGE\n,STG_ACCOUNT.LASTMODIFIEDDATE AS LAST_MODIFIED_DATE\n,STG_ACCOUNT.NPI_VOD__C AS NPI_VOD__C \nFROM\n(select LASTNAME,FIRSTNAME,SALUTATION,LATINNAME,LASTMODIFIEDDATE,EXTERNAL_ID_VOD__C,\nSPECILATY_1_VOD__C,SPECIALTY_2_VOD__C,MIDDLE_VOD__C,LANGUAGE_VOD__C,\nBIIB_CITY__C,BIIB_STATE__C,BIIB_THERAPEUTIC_AREA__C,COUNTRY_VOD__C,BIIB_SEND_to_KME__C,BIIB_KME_Classification__c,NPI_VOD__C from \n (SELECT\nSTG_ACCOUNT.\"LastName\" AS LASTNAME\n,STG_ACCOUNT.\"FirstName\" AS FIRSTNAME \n,STG_ACCOUNT.\"Salutation\" AS SALUTATION \n,NULL AS LATINNAME\n,STG_ACCOUNT.\"LastModifiedDate\" AS LASTMODIFIEDDATE \n,STG_ACCOUNT.\"External_ID_vod__c\" AS EXTERNAL_ID_VOD__C \n,STG_ACCOUNT.\"Specialty_1_vod__c\" AS SPECILATY_1_VOD__C \n,STG_ACCOUNT.\"Specialty_2_vod__c\" AS SPECIALTY_2_VOD__C \n,STG_ACCOUNT.\"Middle_vod__c\" AS MIDDLE_VOD__C\n,STG_ACCOUNT.\"Language_vod__c\" AS LANGUAGE_VOD__C\n,STG_ACCOUNT.\"BIIB_City__c\" AS BIIB_CITY__C\n,STG_ACCOUNT.\"BIIB_State__c\" AS BIIB_STATE__C\n,STG_ACCOUNT.\"BIIB_Therapeutic_Area__c\" AS BIIB_THERAPEUTIC_AREA__C \n,STG_ADDRESS.\"Country_vod__c\" COUNTRY_VOD__C\n,STG_ACCOUNT.\"BIIB_Send_to_KME__c\" AS BIIB_SEND_to_KME__C\n,listagg( distinct concat(STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.Code,'-',STG_PRODUCT_METRICS.\"BIIB_KME_Classification__c\"),';')\nwithin group(order by  concat(STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.Code,'-',STG_PRODUCT_METRICS.\"BIIB_KME_Classification__c\") )\nAS BIIB_KME_Classification__c\n,STG_ACCOUNT.\"NPI_vod__c\" AS NPI_VOD__C \n,row_number()over (partition by STG_ACCOUNT.\"LastName\" ,STG_ACCOUNT.\"FirstName\"  order by STG_ADDRESS.\"Country_vod__c\" desc nulls last) rn\nFROM\n\"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_ACCOUNT\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_ADDRESS\" ON STG_ACCOUNT.\"Id\"=STG_ADDRESS.\"Account_vod__c\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_PRODUCT_METRICS\" ON STG_ACCOUNT.\"Id\"=STG_PRODUCT_METRICS.\"Account_vod__c\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_PRODUCT\" ON STG_PRODUCT.\"Id\"=STG_PRODUCT_METRICS.\"Detail_Group_vod__c\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_KMEE_HUB_DISEASE_AREA_CODE_DESC\" ON STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.DiseaseArea=STG_PRODUCT.\"Name\"\nwhere  STG_ACCOUNT.\"LastModifiedDate\" between dateadd(day,$$day_period,sysdate()) and sysdate()    \nAND STG_ACCOUNT.\"BIIB_Send_to_KME__c\"= 1\nAND STG_ACCOUNT.\"IsDeleted\"= 0\nand STG_ACCOUNT.CURRENT_RECORD_FLG='Y'\nand STG_ADDRESS.CURRENT_RECORD_FLG='Y'\nand STG_PRODUCT_METRICS.CURRENT_RECORD_FLG='Y'\nand STG_PRODUCT.CURRENT_RECORD_FLG='Y' \n--and  STG_ACCOUNT.\"LastName\"  = 'Zimmerman'\n--and STG_ADDRESS.\"Country_vod__c\"  is not null\ngroup by STG_ACCOUNT.\"LastName\" \n,STG_ACCOUNT.\"FirstName\" \n,STG_ACCOUNT.\"Salutation\" \n,STG_ACCOUNT.\"LastModifiedDate\"\n,STG_ACCOUNT.\"External_ID_vod__c\" \n,STG_ACCOUNT.\"Specialty_1_vod__c\"  \n,STG_ACCOUNT.\"Specialty_2_vod__c\" \n,STG_ACCOUNT.\"Middle_vod__c\" \n,STG_ACCOUNT.\"Language_vod__c\" \n,STG_ACCOUNT.\"BIIB_City__c\" \n,STG_ACCOUNT.\"BIIB_State__c\" \n,STG_ACCOUNT.\"BIIB_Therapeutic_Area__c\" \n,STG_ADDRESS.\"Country_vod__c\" \n,STG_ACCOUNT.\"BIIB_Send_to_KME__c\"\n,STG_ACCOUNT.\"NPI_vod__c\") \n where rn =1\n--order by  STG_ACCOUNT.\"LastName\"  desc\nUNION \nSELECT\nSTG_ACCOUNT.\"LastName\" AS LASTNAME\n,STG_ACCOUNT.\"FirstName\" AS FIRSTNAME\n,STG_ACCOUNT.\"Salutation\" AS SALUTATION  \n,concat(IFNULL(STG_ACCOUNT.\"BIIB_Romaji_First_Name__c\",''),' ',IFNULL(STG_ACCOUNT.\"BIIB_Romaji_Last_Name__c\",''),' ',\nIFNULL(STG_ACCOUNT.\"BIIB_Pinyin_Name__c\",'') ) as LATINNAME\n,STG_ACCOUNT.\"LastModifiedDate\" AS LASTMODIFIEDDATE \n,STG_ACCOUNT.\"External_ID_vod__c\" AS EXTERNAL_ID_VOD__C \n,STG_ACCOUNT.\"Specialty_1_vod__c\" AS SPECILATY_1_VOD__C \n,STG_ACCOUNT.\"Specialty_2_vod__c\" AS SPECIALTY_2_VOD__C \n,STG_ACCOUNT.\"Middle_vod__c\" AS MIDDLE_VOD__C \n,STG_ACCOUNT.\"Language_vod__c\" AS LANGUAGE_VOD__C\n,STG_ADDRESS.\"City_vod__c\" AS BIIB_CITY__C\n,STG_ADDRESS.\"State_vod__c\" AS BIIB_STATE__C\n,NULL AS BIIB_THERAPEUTIC_AREA__C\n,STG_COUNTRY.\"Name\" AS COUNTRY_VOD__C\n,STG_ACCOUNT.\"BIIB_Send_to_KMEE_Hub__c\" AS BIIB_SEND_TO_KMEE_HUB__C \n,STG_ACCOUNT.\"BIIB_Thought_Leader__c\" AS BIIB_KME_Classification__c\n,STG_ACCOUNT.\"NPI_vod__c\" AS NPI_VOD__C\nFROM\n\"$$SRC_IHUB_DB\".\"$$SRC_Schema_EU\".\"STG_ACCOUNT\" \nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_EU\".\"STG_COUNTRY\" ON STG_ACCOUNT.\"Country_vod__c\"=STG_COUNTRY.\"Id\"\nLEFT OUTER JOIN  \"$$SRC_IHUB_DB\".\"$$SRC_Schema_EU\".\"STG_ADDRESS\" ON STG_ACCOUNT.\"Id\"=STG_ADDRESS.\"Account_vod__c\"\nWHERE  STG_ACCOUNT.\"LastModifiedDate\" between dateadd(day,$$day_period,sysdate()) and sysdate()   \nAND STG_ACCOUNT.\"BIIB_Send_to_KMEE_Hub__c\"= 1\nAND STG_ADDRESS.\"Primary_vod__c\"=1 \nAND STG_ADDRESS.\"IsDeleted\"=0\nAND STG_ACCOUNT.\"IsDeleted\"= 0 \n) STG_ACCOUNT\nLEFT OUTER JOIN \n(select \"FINAL_VID__V\" as WINNER , \"VID__V\" as LOOSER  from \"$$SRC_NGDW_DB\".\"$$SRC_Schema_SEMANTIC\".\"VNT_ACCOUNT_MERGE_LINEAGE\"\nwhere  to_date(last_modified_time ) between dateadd(day,$$day_period,sysdate()) and sysdate() ) RDM\nON  STG_ACCOUNT.EXTERNAL_ID_VOD__C=RDM.WINNER;",
        "Schema" : "$$SRC_Schema_US"
      },
      "oprRuntimeAttrs" : {
        "schema" : "$$SRC_Schema_US",
        "database" : "$$SRC_IHUB_DB",
        "role" : "$$SRC_Snowflake_Role",
        "warehouse" : "$$SRC_Warehouse",
        "sqloverride" : "SELECT\nSTG_ACCOUNT.EXTERNAL_ID_VOD__C AS MDM_ID\n,RDM.LOOSER AS LOSER_MDM_ID\n,STG_ACCOUNT.BIIB_SEND_to_KME__C AS SEND_TO_KMEE_HUB\n,STG_ACCOUNT.SALUTATION AS SALUTATION\n,STG_ACCOUNT.FIRSTNAME AS FIRST_NAME\n,STG_ACCOUNT.MIDDLE_VOD__C AS MIDDLE_NAME\n,STG_ACCOUNT.LASTNAME AS LAST_NAME\n,ltrim(rtrim(STG_ACCOUNT.LATINNAME)) AS LATIN_NAME\n,STG_ACCOUNT.BIIB_KME_Classification__c AS CLASSIFICATION\n,STG_ACCOUNT.SPECILATY_1_VOD__C AS SPECIALTY_1\n,STG_ACCOUNT.SPECIALTY_2_VOD__C AS SPECIALTY_2\n,STG_ACCOUNT.BIIB_THERAPEUTIC_AREA__C AS THERAPEUTIC_AREA\n,STG_ACCOUNT.COUNTRY_VOD__C AS COUNTRY\n,STG_ACCOUNT.BIIB_STATE__C AS STATE\n,STG_ACCOUNT.BIIB_CITY__C AS CITY\n,STG_ACCOUNT.LANGUAGE_VOD__C AS LANGUAGE\n,STG_ACCOUNT.LASTMODIFIEDDATE AS LAST_MODIFIED_DATE\n,STG_ACCOUNT.NPI_VOD__C AS NPI_VOD__C \nFROM\n(select LASTNAME,FIRSTNAME,SALUTATION,LATINNAME,LASTMODIFIEDDATE,EXTERNAL_ID_VOD__C,\nSPECILATY_1_VOD__C,SPECIALTY_2_VOD__C,MIDDLE_VOD__C,LANGUAGE_VOD__C,\nBIIB_CITY__C,BIIB_STATE__C,BIIB_THERAPEUTIC_AREA__C,COUNTRY_VOD__C,BIIB_SEND_to_KME__C,BIIB_KME_Classification__c,NPI_VOD__C from \n (SELECT\nSTG_ACCOUNT.\"LastName\" AS LASTNAME\n,STG_ACCOUNT.\"FirstName\" AS FIRSTNAME \n,STG_ACCOUNT.\"Salutation\" AS SALUTATION \n,NULL AS LATINNAME\n,STG_ACCOUNT.\"LastModifiedDate\" AS LASTMODIFIEDDATE \n,STG_ACCOUNT.\"External_ID_vod__c\" AS EXTERNAL_ID_VOD__C \n,STG_ACCOUNT.\"Specialty_1_vod__c\" AS SPECILATY_1_VOD__C \n,STG_ACCOUNT.\"Specialty_2_vod__c\" AS SPECIALTY_2_VOD__C \n,STG_ACCOUNT.\"Middle_vod__c\" AS MIDDLE_VOD__C\n,STG_ACCOUNT.\"Language_vod__c\" AS LANGUAGE_VOD__C\n,STG_ACCOUNT.\"BIIB_City__c\" AS BIIB_CITY__C\n,STG_ACCOUNT.\"BIIB_State__c\" AS BIIB_STATE__C\n,STG_ACCOUNT.\"BIIB_Therapeutic_Area__c\" AS BIIB_THERAPEUTIC_AREA__C \n,STG_ADDRESS.\"Country_vod__c\" COUNTRY_VOD__C\n,STG_ACCOUNT.\"BIIB_Send_to_KME__c\" AS BIIB_SEND_to_KME__C\n,listagg( distinct concat(STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.Code,'-',STG_PRODUCT_METRICS.\"BIIB_KME_Classification__c\"),';')\nwithin group(order by  concat(STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.Code,'-',STG_PRODUCT_METRICS.\"BIIB_KME_Classification__c\") )\nAS BIIB_KME_Classification__c\n,STG_ACCOUNT.\"NPI_vod__c\" AS NPI_VOD__C \n,row_number()over (partition by STG_ACCOUNT.\"LastName\" ,STG_ACCOUNT.\"FirstName\"  order by STG_ADDRESS.\"Country_vod__c\" desc nulls last) rn\nFROM\n\"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_ACCOUNT\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_ADDRESS\" ON STG_ACCOUNT.\"Id\"=STG_ADDRESS.\"Account_vod__c\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_PRODUCT_METRICS\" ON STG_ACCOUNT.\"Id\"=STG_PRODUCT_METRICS.\"Account_vod__c\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_PRODUCT\" ON STG_PRODUCT.\"Id\"=STG_PRODUCT_METRICS.\"Detail_Group_vod__c\"\nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_US\".\"STG_KMEE_HUB_DISEASE_AREA_CODE_DESC\" ON STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.DiseaseArea=STG_PRODUCT.\"Name\"\nwhere  STG_ACCOUNT.\"LastModifiedDate\" between dateadd(day,$$day_period,sysdate()) and sysdate()    \nAND STG_ACCOUNT.\"BIIB_Send_to_KME__c\"= 1\nAND STG_ACCOUNT.\"IsDeleted\"= 0\nand STG_ACCOUNT.CURRENT_RECORD_FLG='Y'\nand STG_ADDRESS.CURRENT_RECORD_FLG='Y'\nand STG_PRODUCT_METRICS.CURRENT_RECORD_FLG='Y'\nand STG_PRODUCT.CURRENT_RECORD_FLG='Y' \n--and  STG_ACCOUNT.\"LastName\"  = 'Zimmerman'\n--and STG_ADDRESS.\"Country_vod__c\"  is not null\ngroup by STG_ACCOUNT.\"LastName\" \n,STG_ACCOUNT.\"FirstName\" \n,STG_ACCOUNT.\"Salutation\" \n,STG_ACCOUNT.\"LastModifiedDate\"\n,STG_ACCOUNT.\"External_ID_vod__c\" \n,STG_ACCOUNT.\"Specialty_1_vod__c\"  \n,STG_ACCOUNT.\"Specialty_2_vod__c\" \n,STG_ACCOUNT.\"Middle_vod__c\" \n,STG_ACCOUNT.\"Language_vod__c\" \n,STG_ACCOUNT.\"BIIB_City__c\" \n,STG_ACCOUNT.\"BIIB_State__c\" \n,STG_ACCOUNT.\"BIIB_Therapeutic_Area__c\" \n,STG_ADDRESS.\"Country_vod__c\" \n,STG_ACCOUNT.\"BIIB_Send_to_KME__c\"\n,STG_ACCOUNT.\"NPI_vod__c\") \n where rn =1\n--order by  STG_ACCOUNT.\"LastName\"  desc\nUNION \nSELECT\nSTG_ACCOUNT.\"LastName\" AS LASTNAME\n,STG_ACCOUNT.\"FirstName\" AS FIRSTNAME\n,STG_ACCOUNT.\"Salutation\" AS SALUTATION  \n,concat(IFNULL(STG_ACCOUNT.\"BIIB_Romaji_First_Name__c\",''),' ',IFNULL(STG_ACCOUNT.\"BIIB_Romaji_Last_Name__c\",''),' ',\nIFNULL(STG_ACCOUNT.\"BIIB_Pinyin_Name__c\",'') ) as LATINNAME\n,STG_ACCOUNT.\"LastModifiedDate\" AS LASTMODIFIEDDATE \n,STG_ACCOUNT.\"External_ID_vod__c\" AS EXTERNAL_ID_VOD__C \n,STG_ACCOUNT.\"Specialty_1_vod__c\" AS SPECILATY_1_VOD__C \n,STG_ACCOUNT.\"Specialty_2_vod__c\" AS SPECIALTY_2_VOD__C \n,STG_ACCOUNT.\"Middle_vod__c\" AS MIDDLE_VOD__C \n,STG_ACCOUNT.\"Language_vod__c\" AS LANGUAGE_VOD__C\n,STG_ADDRESS.\"City_vod__c\" AS BIIB_CITY__C\n,STG_ADDRESS.\"State_vod__c\" AS BIIB_STATE__C\n,NULL AS BIIB_THERAPEUTIC_AREA__C\n,STG_COUNTRY.\"Name\" AS COUNTRY_VOD__C\n,STG_ACCOUNT.\"BIIB_Send_to_KMEE_Hub__c\" AS BIIB_SEND_TO_KMEE_HUB__C \n,STG_ACCOUNT.\"BIIB_Thought_Leader__c\" AS BIIB_KME_Classification__c\n,STG_ACCOUNT.\"NPI_vod__c\" AS NPI_VOD__C\nFROM\n\"$$SRC_IHUB_DB\".\"$$SRC_Schema_EU\".\"STG_ACCOUNT\" \nLEFT OUTER JOIN \"$$SRC_IHUB_DB\".\"$$SRC_Schema_EU\".\"STG_COUNTRY\" ON STG_ACCOUNT.\"Country_vod__c\"=STG_COUNTRY.\"Id\"\nLEFT OUTER JOIN  \"$$SRC_IHUB_DB\".\"$$SRC_Schema_EU\".\"STG_ADDRESS\" ON STG_ACCOUNT.\"Id\"=STG_ADDRESS.\"Account_vod__c\"\nWHERE  STG_ACCOUNT.\"LastModifiedDate\" between dateadd(day,$$day_period,sysdate()) and sysdate()   \nAND STG_ACCOUNT.\"BIIB_Send_to_KMEE_Hub__c\"= 1\nAND STG_ADDRESS.\"Primary_vod__c\"=1 \nAND STG_ADDRESS.\"IsDeleted\"=0\nAND STG_ACCOUNT.\"IsDeleted\"= 0 \n) STG_ACCOUNT\nLEFT OUTER JOIN \n(select \"FINAL_VID__V\" as WINNER , \"VID__V\" as LOOSER  from \"$$SRC_NGDW_DB\".\"$$SRC_Schema_SEMANTIC\".\"VNT_ACCOUNT_MERGE_LINEAGE\"\nwhere  to_date(last_modified_time ) between dateadd(day,$$day_period,sysdate()) and sysdate() ) RDM\nON  STG_ACCOUNT.EXTERNAL_ID_VOD__C=RDM.WINNER;"
      },
      "customQuery" : "SELECT\nSTG_ACCOUNT.EXTERNAL_ID_VOD__C AS MDM_ID\n,RDM.LOOSER AS LOSER_MDM_ID\n,STG_ACCOUNT.BIIB_SEND_to_KME__C AS SEND_TO_KMEE_HUB\n,STG_ACCOUNT.SALUTATION AS SALUTATION\n,STG_ACCOUNT.FIRSTNAME AS FIRST_NAME\n,STG_ACCOUNT.MIDDLE_VOD__C AS MIDDLE_NAME\n,STG_ACCOUNT.LASTNAME AS LAST_NAME\n,ltrim(rtrim(STG_ACCOUNT.LATINNAME)) AS LATIN_NAME\n,STG_ACCOUNT.BIIB_KME_Classification__c AS CLASSIFICATION\n,STG_ACCOUNT.SPECILATY_1_VOD__C AS SPECIALTY_1\n,STG_ACCOUNT.SPECIALTY_2_VOD__C AS SPECIALTY_2\n,STG_ACCOUNT.BIIB_THERAPEUTIC_AREA__C AS THERAPEUTIC_AREA\n,STG_ACCOUNT.COUNTRY_VOD__C AS COUNTRY\n,STG_ACCOUNT.BIIB_STATE__C AS STATE\n,STG_ACCOUNT.BIIB_CITY__C AS CITY\n,STG_ACCOUNT.LANGUAGE_VOD__C AS LANGUAGE\n,STG_ACCOUNT.LASTMODIFIEDDATE AS LAST_MODIFIED_DATE\n,STG_ACCOUNT.NPI_VOD__C AS NPI_VOD__C \nFROM\n(\nSELECT\nSTG_ACCOUNT.\"LastName\" AS LASTNAME\n,STG_ACCOUNT.\"FirstName\" AS FIRSTNAME \n,STG_ACCOUNT.\"Salutation\" AS SALUTATION \n,NULL AS LATINNAME\n,STG_ACCOUNT.\"LastModifiedDate\" AS LASTMODIFIEDDATE \n,STG_ACCOUNT.\"External_ID_vod__c\" AS EXTERNAL_ID_VOD__C \n,STG_ACCOUNT.\"Specialty_1_vod__c\" AS SPECILATY_1_VOD__C \n,STG_ACCOUNT.\"Specialty_2_vod__c\" AS SPECIALTY_2_VOD__C \n,STG_ACCOUNT.\"Middle_vod__c\" AS MIDDLE_VOD__C\n,STG_ACCOUNT.\"Language_vod__c\" AS LANGUAGE_VOD__C\n,STG_ACCOUNT.\"BIIB_City__c\" AS BIIB_CITY__C\n,STG_ACCOUNT.\"BIIB_State__c\" AS BIIB_STATE__C\n,STG_ACCOUNT.\"BIIB_Therapeutic_Area__c\" AS BIIB_THERAPEUTIC_AREA__C \n,STG_ADDRESS.\"Country_vod__c\" COUNTRY_VOD__C\n,STG_ACCOUNT.\"BIIB_Send_to_KME__c\" AS BIIB_SEND_to_KME__C\n,listagg( distinct concat(STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.Code,'-',STG_PRODUCT_METRICS.\"BIIB_KME_Classification__c\"),';')\nwithin group(order by  concat(STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.Code,'-',STG_PRODUCT_METRICS.\"BIIB_KME_Classification__c\") )\nAS BIIB_KME_Classification__c\n,STG_ACCOUNT.\"NPI_vod__c\" AS NPI_VOD__C \nFROM\n\"IHUB_TEST\".\"ISTAGE\".\"STG_ACCOUNT\"\nLEFT OUTER JOIN \"IHUB_TEST\".\"ISTAGE\".\"STG_ADDRESS\" ON STG_ACCOUNT.\"Id\"=STG_ADDRESS.\"Account_vod__c\"\nLEFT OUTER JOIN \"IHUB_TEST\".\"ISTAGE\".\"STG_PRODUCT_METRICS\" ON STG_ACCOUNT.\"Id\"=STG_PRODUCT_METRICS.\"Account_vod__c\"\nLEFT OUTER JOIN \"IHUB_TEST\".\"ISTAGE\".\"STG_PRODUCT\" ON STG_PRODUCT.\"Id\"=STG_PRODUCT_METRICS.\"Detail_Group_vod__c\"\nLEFT OUTER JOIN \"IHUB_TEST\".\"ISTAGE\".\"STG_KMEE_HUB_DISEASE_AREA_CODE_DESC\" ON STG_KMEE_HUB_DISEASE_AREA_CODE_DESC.DiseaseArea=STG_PRODUCT.\"Name\"\nwhere  STG_ACCOUNT.\"LastModifiedDate\" between dateadd(day,-50,sysdate()) and sysdate()    \nAND STG_ACCOUNT.\"BIIB_Send_to_KME__c\"= 1\nAND STG_ACCOUNT.\"IsDeleted\"= 0\nand STG_ACCOUNT.CURRENT_RECORD_FLG='Y'\nand STG_ADDRESS.CURRENT_RECORD_FLG='Y'\nand STG_PRODUCT_METRICS.CURRENT_RECORD_FLG='Y'\nand STG_PRODUCT.CURRENT_RECORD_FLG='Y' \ngroup by STG_ACCOUNT.\"LastName\" \n,STG_ACCOUNT.\"FirstName\" \n,STG_ACCOUNT.\"Salutation\" \n,STG_ACCOUNT.\"LastModifiedDate\"\n,STG_ACCOUNT.\"External_ID_vod__c\" \n,STG_ACCOUNT.\"Specialty_1_vod__c\"  \n,STG_ACCOUNT.\"Specialty_2_vod__c\" \n,STG_ACCOUNT.\"Middle_vod__c\" \n,STG_ACCOUNT.\"Language_vod__c\" \n,STG_ACCOUNT.\"BIIB_City__c\" \n,STG_ACCOUNT.\"BIIB_State__c\" \n,STG_ACCOUNT.\"BIIB_Therapeutic_Area__c\" \n,STG_ADDRESS.\"Country_vod__c\" \n,STG_ACCOUNT.\"BIIB_Send_to_KME__c\"\n,STG_ACCOUNT.\"NPI_vod__c\"\nUNION \nSELECT\nSTG_ACCOUNT.\"LastName\" AS LASTNAME\n,STG_ACCOUNT.\"FirstName\" AS FIRSTNAME\n,STG_ACCOUNT.\"Salutation\" AS SALUTATION  \n,concat(IFNULL(STG_ACCOUNT.\"BIIB_Romaji_First_Name__c\",''),' ',IFNULL(STG_ACCOUNT.\"BIIB_Romaji_Last_Name__c\",''),' ',\nIFNULL(STG_ACCOUNT.\"BIIB_Pinyin_Name__c\",'') ) as LATINNAME\n,STG_ACCOUNT.\"LastModifiedDate\" AS LASTMODIFIEDDATE \n,STG_ACCOUNT.\"External_ID_vod__c\" AS EXTERNAL_ID_VOD__C \n,STG_ACCOUNT.\"Specialty_1_vod__c\" AS SPECILATY_1_VOD__C \n,STG_ACCOUNT.\"Specialty_2_vod__c\" AS SPECIALTY_2_VOD__C \n,STG_ACCOUNT.\"Middle_vod__c\" AS MIDDLE_VOD__C \n,STG_ACCOUNT.\"Language_vod__c\" AS LANGUAGE_VOD__C\n,STG_ADDRESS.\"City_vod__c\" AS BIIB_CITY__C\n,STG_ADDRESS.\"State_vod__c\" AS BIIB_STATE__C\n,NULL AS BIIB_THERAPEUTIC_AREA__C\n,STG_COUNTRY.\"Name\" AS COUNTRY_VOD__C\n,STG_ACCOUNT.\"BIIB_Send_to_KMEE_Hub__c\" AS BIIB_SEND_TO_KMEE_HUB__C \n,STG_ACCOUNT.\"BIIB_Thought_Leader__c\" AS BIIB_KME_Classification__c\n,STG_ACCOUNT.\"NPI_vod__c\" AS NPI_VOD__C\nFROM\n\"IHUB_TEST\".\"ISTAGE_INTL\".\"STG_ACCOUNT\"\nLEFT OUTER JOIN \"IHUB_TEST\".\"ISTAGE_INTL\".\"STG_COUNTRY\" ON STG_ACCOUNT.\"Country_vod__c\"=STG_COUNTRY.\"Id\"\nLEFT OUTER JOIN \"IHUB_TEST\".\"ISTAGE_INTL\".\"STG_ADDRESS\" ON STG_ACCOUNT.\"Id\"=STG_ADDRESS.\"Account_vod__c\"\nWHERE  STG_ACCOUNT.\"LastModifiedDate\" between dateadd(day,-50,sysdate()) and sysdate()   \nAND STG_ACCOUNT.\"BIIB_Send_to_KMEE_Hub__c\"= 1\nAND STG_ADDRESS.\"Primary_vod__c\"=1 \nAND STG_ADDRESS.\"IsDeleted\"=0\nAND STG_ACCOUNT.\"IsDeleted\"= 0 \n) STG_ACCOUNT\nLEFT OUTER JOIN \n(select \"FINAL_VID__V\" as WINNER , \"VID__V\" as LOOSER  from \"NGDW_TEST\".\"SEMANTIC\".\"VNT_ACCOUNT_MERGE_LINEAGE\"\nwhere  to_date(last_modified_time ) between dateadd(day,-50,sysdate()) and sysdate() ) RDM\nON  STG_ACCOUNT.EXTERNAL_ID_VOD__C=RDM.WINNER;\n",
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "Src_Connection_Snowflake",
        "objectParameterName" : "Src_Query",
        "connectionRuntimeParameter" : false,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$tgt_veevacrm_file$",
      "type" : "TARGET",
      "label" : "Tgt_FlatFile_connection",
      "uiProperties" : {
        "cnxtype" : "CSVFile",
        "connectionParameterized" : "true",
        "paramName" : "Tgt_FlatFile_connection",
        "paramType-mapping" : "Connection",
        "logcnx" : "Tgt_FlatFile_connection",
        "objlabel" : "Tgt_FileName",
        "objectParameterized" : "true",
        "objectParamName" : "Tgt_FileName",
        "objectParamType-mapping" : "DataObject",
        "fieldMappingParameterized" : "true",
        "supportApplyDDLChanges" : "false",
        "originalPath" : "tgt_veevacrm_file"
      },
      "targetConnectionId" : "@gNtp0i7pJYCb70T4XGu8AR",
      "connectionName" : "VCRM_Accounts_KMEE_Hub_FlatFile",
      "targetObject" : "veevacrm.csv",
      "targetObjectLabel" : "veevacrm.csv",
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "operationType" : "Insert",
      "tgtFFAttrs" : {
        "delimiter" : ",",
        "textQualifier" : "\"",
        "headerLineNo" : 1,
        "rowDelimiter" : 0,
        "consecutiveDelimiter" : false,
        "multiDelimitersAsAnd" : true
      },
      "customFuncCfg" : { },
      "extendedObject" : {
        "singleMode" : true
      },
      "runtimeAttrs" : {
        "Output file directory" : "$$TgtFilesDir"
      },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "objectName" : "veevacrm.csv",
      "objectLabel" : "veevacrm.csv",
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionParameterName" : "Tgt_FlatFile_connection",
        "objectParameterName" : "Tgt_FileName",
        "objectDefaultValue" : "veevacrm.csv",
        "connectionRuntimeParameter" : true,
        "objectRuntimeParameter" : true
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    },
    {
      "name" : "$field_mapping$",
      "type" : "STRING",
      "text" : "nstring (120, 0) MDM_ID=MDM_ID;nstring (16777216, 0) LOSER_MDM_ID=LOSER_MDM_ID;nstring (255, 0) SEND_TO_KMEE_HUB=SEND_TO_KMEE_HUB;nstring (40, 0) SALUTATION=SALUTATION;nstring (40, 0) FIRST_NAME=FIRST_NAME;nstring (40, 0) MIDDLE_NAME=MIDDLE_NAME;nstring (80, 0) LAST_NAME=LAST_NAME;nstring (767, 0) LATIN_NAME=LATIN_NAME;nstring (16777216, 0) CLASSIFICATION=CLASSIFICATION;nstring (255, 0) SPECIALTY_1=SPECIALTY_1;nstring (255, 0) SPECIALTY_2=SPECIALTY_2;nstring (4099, 0) THERAPEUTIC_AREA=THERAPEUTIC_AREA;nstring (255, 0) COUNTRY=COUNTRY;nstring (1300, 0) STATE=STATE;nstring (1300, 0) CITY=CITY;nstring (255, 0) LANGUAGE=LANGUAGE;nstring (255, 0) LAST_MODIFIED_DATE=LAST_MODIFIED_DATE;nstring (25, 0) NPI_ID=NPI_VOD__C;",
      "label" : "field_mapping",
      "uiProperties" : {
        "paramName" : "field_mapping",
        "paramType-mapping" : "FieldMapping",
        "paramtype" : "Fieldmap",
        "supressFieldmappingSuffix" : "true",
        "lefttitle" : "Incoming Fields",
        "righttitle" : "Target Fields",
        "isPwxMultiGroupFieldMapping" : "false",
        "objlabel" : "Target Field Group:",
        "originalPath" : "tgt_veevacrm_file"
      },
      "newFlatFile" : false,
      "newObject" : false,
      "showBusinessNames" : true,
      "naturalOrder" : true,
      "truncateTarget" : false,
      "bulkApiDBTarget" : false,
      "customFuncCfg" : { },
      "commandType" : 0,
      "handleSpecialChars" : false,
      "handleDecimalRoundOff" : false,
      "frsAsset" : false,
      "dynamicFileName" : false,
      "excludeDynamicFileNameField" : false,
      "currentlyProcessedFileName" : false,
      "retainFieldMetadata" : false,
      "useExactSrcNames" : false,
      "userUpdated" : true,
      "runtimeParameterData" : {
        "connectionRuntimeParameter" : false,
        "objectRuntimeParameter" : false
      },
      "restmodernSource" : true,
      "unspecified" : false,
      "fileList" : false
    }
  ],
  "verbose" : false,
  "mappingId" : "@6LWbQKwa8SmkletTR8FuUI",
  "mappingTemplateName" : "m_us_intl_report_to_kme_hub",
  "hidden" : false,
  "enableCrossSchemaPushdown" : true,
  "enableParallelRun" : false,
  "autoTunedApplied" : false,
  "autoTunedAppliedType" : "NONE",
  "parameterFileName" : "Audit.prm",
  "parameterFileDir" : "/u01/app/Parmfiles/commercial/VCRM_Accounts_KMEE_Hub",
  "paramFileType" : "PARAM_FILE_LOCAL",
  "schemaMode" : "async",
  "valid" : false,
  "parameterFileEncoding" : "UTF-8",
  "allowMaxFieldLength" : false,
  "specialCharacterSupport" : false,
  "midstreamPreview" : false,
  "vcsExportTime" : "2025-08-20 11:26:28 CDT"
}